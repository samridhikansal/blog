{% extends 'base.html' %}

{% block content %}
<div class="container">
  <!-- System messages section  -->
  {% if messages %}
    {% for message in messages %}
    <div class="alert alert-success mt-2" role="alert">{{message}}</div>
    {% endfor%}
  {% endif %}
<!-- Messages section ends  -->

<!-- Post section begins -->
 <section class="container mb-5">
    <article class="post">
      <h2 class="post-title">{{ post.name }}</h2>

      <p>{{post.desc}}</p>
      <h5>Author: {{post.author}}</h3>
    </article>
</section>
<!-- post section ends  -->
 
<!-- Like dislike section begins -->
<section class="container mb-5">
  <div class="container d-flex flex-row justify-content-between">
    {% if post_like_dislike.dislike %}
    <a class="badge bg-secondary text-decoration-none link-light" href="{% url 'total_likes' id=post.id %}">Like</a>
    
    {% elif post_like_dislike.like %}
    <a class="badge bg-secondary text-decoration-none link-light" href="{% url 'total_dislikes' id=post.id %}">Dislike</a>
    {% else %}
    <a class="badge bg-secondary text-decoration-none link-light" href="{% url 'total_likes' id=post.id %}">Like</a>
    <a  class="badge bg-secondary text-decoration-none link-light" href="{% url 'total_likes' id=post.id %}">Dislike</a>
    {% endif %}
    <a  class="badge bg-secondary text-decoration-none link-light" href="{% url 'follow' id=post.id username=post.author  %}">Follow the Author</a>

  </div>
  <div>
    <div>Total likes on this post: {{post.total_likes}}</div>
    <div>Total Dislike on this post:{{post.total_dislikes}} </div>
  </div>
</section>
<!-- Like diskike section ends -->

<!-- Add comments section begins -->
 {% if form %}
<section class="container mb-5">

   <form class="w-60 d-flex flex-column justify-content-center mb-5 " method="post" enctype="multipart/form-data" action="{% url 'comments' post_id=post.id %}">

             {% csrf_token%}
             {% for field in form %}
                   <div class="mb-3 row form-group">
                      <div class="col-sm-2 col-form-label"> {{field.label}}</div> 
                       <div class="col-sm-10"> {{field}}</div>
                   </div>
             {% endfor %}
            <div class="d-flex flex-row justify-content-center align-items-center ">
                   <button class="btn btn-secondary " type="submit">Add comment</button>
            </div> 
       </form>
    

    
</section>
{% endif %}

  {% if comments %}
  <section class="container  pt-3 pb-3">
    <h2>Comments</h2>
    {% for comment in comments %}
    <div class="d-flex flex-row mt-2">
        <div class="col-sm-2">{{comment.author}}</div> 
        <div class="vr"></div>
        <div class=" mx-2 col-sm-7">{{comment.comment}} </div>
        <form method="post" action = "{% url 'comments_reply' id=comment.id  post_id=post.id %}">
          {%csrf_token%}
          {{reply_form}}
        
          <button class="btn btn-primary mb-2">Reply</button>

        </form>
      </div>
      
    <div class=" border border-bottom border-primary"></div>
     
    {% endfor %}
  </section>
  {% endif %}
</div>
{% endblock %}




